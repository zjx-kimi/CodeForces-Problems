## Description

<div><p>Whoa! You did a great job helping Team Rocket who managed to capture all the Pokemons sent by Bash. Meowth, part of Team Rocket, having already mastered the human language, now wants to become a master in programming as well. He agrees to free the Pokemons if Bash can answer his questions.</p><p>Initially, Meowth gives Bash a weighted tree containing <span class="tex-span"><i>n</i></span> nodes and a sequence <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> which is a permutation of <span class="tex-span">1, 2, ..., <i>n</i></span>. Now, Mewoth makes <span class="tex-span"><i>q</i></span> queries of one of the following forms:</p><ul>  <li> <span class="tex-font-style-tt">1 l r v</span>: meaning Bash should report <img align="middle" class="tex-formula" src="file://88ULGi31.png" style="max-width: 100.0%;max-height: 100.0%;">, where <span class="tex-span"><i>dist</i>(<i>a</i>, <i>b</i>)</span> is the length of the shortest path from node <span class="tex-span"><i>a</i></span> to node <span class="tex-span"><i>b</i></span> in the given tree.  </li><li> <span class="tex-font-style-tt">2 x</span>: meaning Bash should swap <span class="tex-span"><i>a</i><sub class="lower-index"><i>x</i></sub></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>x</i> + 1</sub></span> in the given sequence. This new sequence is used for later queries. </li></ul><p>Help Bash to answer the questions!</p></div><div class="input-specification"><p>The first line contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>q</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 2·10<sup class="upper-index">5</sup></span>, <span class="tex-span">1 ≤ <i>q</i> ≤ 2·10<sup class="upper-index">5</sup></span>)&nbsp;— the number of nodes in the tree and the number of queries, respectively.</p><p>The next line contains <span class="tex-span"><i>n</i></span> space-separated integers&nbsp;— the sequence <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> which is a permutation of <span class="tex-span">1, 2, ..., <i>n</i></span>.</p><p>Each of the next <span class="tex-span"><i>n</i> - 1</span> lines contain three space-separated integers <span class="tex-span"><i>u</i></span>, <span class="tex-span"><i>v</i></span>, and <span class="tex-span"><i>w</i></span> denoting that there exists an undirected edge between node <span class="tex-span"><i>u</i></span> and node <span class="tex-span"><i>v</i></span> of weight <span class="tex-span"><i>w</i></span>, (<span class="tex-span">1 ≤ <i>u</i>, <i>v</i> ≤ <i>n</i></span>, <span class="tex-span"><i>u</i> ≠ <i>v</i></span>, <span class="tex-span">1 ≤ <i>w</i> ≤ 10<sup class="upper-index">6</sup></span>). It is guaranteed that the given graph is a tree.</p><p>Each query consists of two lines. First line contains single integer <span class="tex-span"><i>t</i></span>, indicating the type of the query. Next line contains the description of the query: </p><ul> <li> <span class="tex-font-style-bf">t = 1</span>: Second line contains three integers <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span> and <span class="tex-span"><i>c</i></span> (<span class="tex-span">1 ≤ <i>a</i>, <i>b</i>, <i>c</i> &lt; 2<sup class="upper-index">30</sup></span>) using which <span class="tex-span"><i>l</i></span>, <span class="tex-span"><i>r</i></span> and <span class="tex-span"><i>v</i></span> can be generated using the formula given below: <ul> <li> <img align="middle" class="tex-formula" src="file://QgccisS9.png" style="max-width: 100.0%;max-height: 100.0%;">, </li><li> <img align="middle" class="tex-formula" src="file://D04AJXYW.png" style="max-width: 100.0%;max-height: 100.0%;">, </li><li> <img align="middle" class="tex-formula" src="file://E5L9lHNW.png" style="max-width: 100.0%;max-height: 100.0%;">. </li></ul> </li><li> <span class="tex-font-style-bf">t = 2</span>: Second line contains single integer <span class="tex-span"><i>a</i></span> (<span class="tex-span">1 ≤ <i>a</i> &lt; 2<sup class="upper-index">30</sup></span>) using which <span class="tex-span"><i>x</i></span> can be generated using the formula given below: <ul> <li> <img align="middle" class="tex-formula" src="file://BD1YHPfw.png" style="max-width: 100.0%;max-height: 100.0%;">. </li></ul> </li></ul><p>The <span class="tex-span"><i>ans</i><sub class="lower-index"><i>i</i></sub></span> is the answer for the <span class="tex-span"><i>i</i></span>-th query, assume that <span class="tex-span"><i>ans</i><sub class="lower-index">0</sub> = 0</span>. If the <span class="tex-span"><i>i</i></span>-th query is of type 2 then <span class="tex-span"><i>ans</i><sub class="lower-index"><i>i</i></sub></span> = <span class="tex-span"><i>ans</i><sub class="lower-index"><i>i</i> - 1</sub></span>. It is guaranteed that: </p><ul> <li> <span class="tex-font-style-bf">for each query of type 1</span>: <span class="tex-span">1 ≤ <i>l</i> ≤ <i>r</i> ≤ <i>n</i></span>, <span class="tex-span">1 ≤ <i>v</i> ≤ <i>n</i></span>, </li><li> <span class="tex-font-style-bf">for each query of type 2</span>: <span class="tex-span">1 ≤ <i>x</i> ≤ <i>n</i> - 1</span>. </li></ul><p>The <img align="middle" class="tex-formula" src="file://uzSxLvIT.png" style="max-width: 100.0%;max-height: 100.0%;"> operation means bitwise exclusive OR.</p></div><div class="output-specification"><p>For each query of type <span class="tex-span">1</span>, output a single integer in a separate line, denoting the answer to the query.</p></div>

## Input

<p>The first line contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>q</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 2·10<sup class="upper-index">5</sup></span>, <span class="tex-span">1 ≤ <i>q</i> ≤ 2·10<sup class="upper-index">5</sup></span>)&nbsp;— the number of nodes in the tree and the number of queries, respectively.</p><p>The next line contains <span class="tex-span"><i>n</i></span> space-separated integers&nbsp;— the sequence <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> which is a permutation of <span class="tex-span">1, 2, ..., <i>n</i></span>.</p><p>Each of the next <span class="tex-span"><i>n</i> - 1</span> lines contain three space-separated integers <span class="tex-span"><i>u</i></span>, <span class="tex-span"><i>v</i></span>, and <span class="tex-span"><i>w</i></span> denoting that there exists an undirected edge between node <span class="tex-span"><i>u</i></span> and node <span class="tex-span"><i>v</i></span> of weight <span class="tex-span"><i>w</i></span>, (<span class="tex-span">1 ≤ <i>u</i>, <i>v</i> ≤ <i>n</i></span>, <span class="tex-span"><i>u</i> ≠ <i>v</i></span>, <span class="tex-span">1 ≤ <i>w</i> ≤ 10<sup class="upper-index">6</sup></span>). It is guaranteed that the given graph is a tree.</p><p>Each query consists of two lines. First line contains single integer <span class="tex-span"><i>t</i></span>, indicating the type of the query. Next line contains the description of the query: </p><ul> <li> <span class="tex-font-style-bf">t = 1</span>: Second line contains three integers <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span> and <span class="tex-span"><i>c</i></span> (<span class="tex-span">1 ≤ <i>a</i>, <i>b</i>, <i>c</i> &lt; 2<sup class="upper-index">30</sup></span>) using which <span class="tex-span"><i>l</i></span>, <span class="tex-span"><i>r</i></span> and <span class="tex-span"><i>v</i></span> can be generated using the formula given below: <ul> <li> <img align="middle" class="tex-formula" src="file://QgccisS9.png" style="max-width: 100.0%;max-height: 100.0%;">, </li><li> <img align="middle" class="tex-formula" src="file://D04AJXYW.png" style="max-width: 100.0%;max-height: 100.0%;">, </li><li> <img align="middle" class="tex-formula" src="file://E5L9lHNW.png" style="max-width: 100.0%;max-height: 100.0%;">. </li></ul> </li><li> <span class="tex-font-style-bf">t = 2</span>: Second line contains single integer <span class="tex-span"><i>a</i></span> (<span class="tex-span">1 ≤ <i>a</i> &lt; 2<sup class="upper-index">30</sup></span>) using which <span class="tex-span"><i>x</i></span> can be generated using the formula given below: <ul> <li> <img align="middle" class="tex-formula" src="file://BD1YHPfw.png" style="max-width: 100.0%;max-height: 100.0%;">. </li></ul> </li></ul><p>The <span class="tex-span"><i>ans</i><sub class="lower-index"><i>i</i></sub></span> is the answer for the <span class="tex-span"><i>i</i></span>-th query, assume that <span class="tex-span"><i>ans</i><sub class="lower-index">0</sub> = 0</span>. If the <span class="tex-span"><i>i</i></span>-th query is of type 2 then <span class="tex-span"><i>ans</i><sub class="lower-index"><i>i</i></sub></span> = <span class="tex-span"><i>ans</i><sub class="lower-index"><i>i</i> - 1</sub></span>. It is guaranteed that: </p><ul> <li> <span class="tex-font-style-bf">for each query of type 1</span>: <span class="tex-span">1 ≤ <i>l</i> ≤ <i>r</i> ≤ <i>n</i></span>, <span class="tex-span">1 ≤ <i>v</i> ≤ <i>n</i></span>, </li><li> <span class="tex-font-style-bf">for each query of type 2</span>: <span class="tex-span">1 ≤ <i>x</i> ≤ <i>n</i> - 1</span>. </li></ul><p>The <img align="middle" class="tex-formula" src="file://uzSxLvIT.png" style="max-width: 100.0%;max-height: 100.0%;"> operation means bitwise exclusive OR.</p>

## Output

<p>For each query of type <span class="tex-span">1</span>, output a single integer in a separate line, denoting the answer to the query.</p>





```input1
5 5
4 5 1 3 2
4 2 4
1 3 9
4 1 4
4 5 2
1
1 5 4
1
22 20 20
2
38
2
39
1
36 38 38

```




```output1
23
37
28

```



## Note

<p>In the sample, the actual queries are the following: </p><ul> <li> <span class="tex-font-style-tt">1 1 5 4</span> </li><li> <span class="tex-font-style-tt">1 1 3 3</span> </li><li> <span class="tex-font-style-tt">2 3</span> </li><li> <span class="tex-font-style-tt">2 2</span> </li><li> <span class="tex-font-style-tt">1 1 3 3</span> </li></ul>
