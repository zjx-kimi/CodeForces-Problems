## Description

<div><p>Whereas humans nowadays read fewer and fewer books on paper, book readership among marmots has surged. Heidi has expanded the library and is now serving longer request sequences.</p></div><div class="input-specification"><p>Same as the easy version, but the limits have changed: <span class="tex-span">1 ≤ <i>n</i>, <i>k</i> ≤ 400 000</span>.</p></div><div class="output-specification"><p>Same as the easy version.</p></div>

## Input

<p>Same as the easy version, but the limits have changed: <span class="tex-span">1 ≤ <i>n</i>, <i>k</i> ≤ 400 000</span>.</p>

## Output

<p>Same as the easy version.</p>





```input1
4 100
1 2 2 1

```




```input2
4 1
1 2 2 1

```




```input3
4 2
1 2 3 1

```




```output1
2

```




```output2
3

```




```output3
3

```


