## Description

<div><p>Zombies seem to have become much more intelligent lately – a few have somehow wandered into the base through the automatic gate. Heidi has had to beef up security, and a new gate has been installed. Unfortunately, now the questions being asked are more complicated, and even humans have trouble answering them. Can you still program the robot army to do this reliably?</p><p>The new questions are of the following form: a grayscale photograph has been divided into several horizontal pieces, which have been arbitrarily rearranged. The task is to assemble the original image back from these pieces (somewhat like in a jigsaw puzzle). To further delay the zombies, significant Gaussian-distributed noise has been added to the image.</p></div><div class="input-specification"><p>The input format is the same as in the previous version, except that the first line of every question now contains three space-separated numbers <span class="tex-span"><i>h</i></span>, <span class="tex-span"><i>w</i></span> and <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>h</i>, <i>w</i> ≤ 600</span>, <span class="tex-span">2 ≤ <i>k</i> ≤ 16</span>) – the height (number of rows) and width (number of columns) of the photograph and the number of pieces, respectively. The number of pieces evenly divides the height, and each piece is of the same height <span class="tex-span"><i>h</i> / <i>k</i></span>.</p><p>Again, there is only one input file to be processed, and the same resources are provided to you as in the previous version (except that now you are given <span class="tex-font-style-it">all</span> input images in <span class="tex-font-style-tt">.bmp</span> format, rather than the first 50).</p></div><div class="output-specification"><p>Your program should print <span class="tex-span"><i>q</i></span> lines. The <span class="tex-span"><i>i</i></span>-th line should contain your answer for the <span class="tex-span"><i>i</i></span>-th question: a space-separated sequence of <span class="tex-span"><i>k</i></span> numbers <span class="tex-span">π<sub class="lower-index">1</sub>, π<sub class="lower-index">2</sub>, ..., π<sub class="lower-index"><i>k</i></sub></span> such that: </p><ul> <li> <span class="tex-span">π</span> is a permutation of <span class="tex-span">{1, 2, ..., <i>k</i>}</span>, that is, each number from <span class="tex-span">1</span> to <span class="tex-span"><i>k</i></span> appears exactly once in <span class="tex-span">π</span>, </li><li> for each <span class="tex-span"><i>j</i> = 1, ..., <i>k</i></span>, <span class="tex-span">π<sub class="lower-index"><i>j</i></sub></span> is the position (index), in the original image, of the piece which is at position <span class="tex-span"><i>j</i></span> in the input image. (See the illustration below for clarity.) </li></ul><center> <img class="tex-graphics" height="161px" src="file://ISMQMzR2.png" style="max-width: 100.0%;max-height: 100.0%;" width="567px"><p><span class="tex-font-size-small">The second image from the test set. If the three pieces in the original image are numbered <span class="tex-span">1</span>, <span class="tex-span">2</span>, <span class="tex-span">3</span> from top to bottom, then the numbering in the image on the right should be <span class="tex-span">2</span>, <span class="tex-span">3</span>, <span class="tex-span">1</span>. The correct answer for this image is thus <span class="tex-font-style-tt">2 3 1</span>.</span> </p></center><p>Again, your answers will be accepted if they conform to this format and if at least <span class="tex-span">75%</span> of them are correct.</p><p>Again, you may process the input locally and submit just your precomputed answers (i.e., a program which just prints your output for the input file <span class="tex-font-style-tt">all.in</span>).</p></div>

## Input

<p>The input format is the same as in the previous version, except that the first line of every question now contains three space-separated numbers <span class="tex-span"><i>h</i></span>, <span class="tex-span"><i>w</i></span> and <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>h</i>, <i>w</i> ≤ 600</span>, <span class="tex-span">2 ≤ <i>k</i> ≤ 16</span>) – the height (number of rows) and width (number of columns) of the photograph and the number of pieces, respectively. The number of pieces evenly divides the height, and each piece is of the same height <span class="tex-span"><i>h</i> / <i>k</i></span>.</p><p>Again, there is only one input file to be processed, and the same resources are provided to you as in the previous version (except that now you are given <span class="tex-font-style-it">all</span> input images in <span class="tex-font-style-tt">.bmp</span> format, rather than the first 50).</p>

## Output

<p>Your program should print <span class="tex-span"><i>q</i></span> lines. The <span class="tex-span"><i>i</i></span>-th line should contain your answer for the <span class="tex-span"><i>i</i></span>-th question: a space-separated sequence of <span class="tex-span"><i>k</i></span> numbers <span class="tex-span">π<sub class="lower-index">1</sub>, π<sub class="lower-index">2</sub>, ..., π<sub class="lower-index"><i>k</i></sub></span> such that: </p><ul> <li> <span class="tex-span">π</span> is a permutation of <span class="tex-span">{1, 2, ..., <i>k</i>}</span>, that is, each number from <span class="tex-span">1</span> to <span class="tex-span"><i>k</i></span> appears exactly once in <span class="tex-span">π</span>, </li><li> for each <span class="tex-span"><i>j</i> = 1, ..., <i>k</i></span>, <span class="tex-span">π<sub class="lower-index"><i>j</i></sub></span> is the position (index), in the original image, of the piece which is at position <span class="tex-span"><i>j</i></span> in the input image. (See the illustration below for clarity.) </li></ul><center> <img class="tex-graphics" height="161px" src="file://ISMQMzR2.png" style="max-width: 100.0%;max-height: 100.0%;" width="567px"><p><span class="tex-font-size-small">The second image from the test set. If the three pieces in the original image are numbered <span class="tex-span">1</span>, <span class="tex-span">2</span>, <span class="tex-span">3</span> from top to bottom, then the numbering in the image on the right should be <span class="tex-span">2</span>, <span class="tex-span">3</span>, <span class="tex-span">1</span>. The correct answer for this image is thus <span class="tex-font-style-tt">2 3 1</span>.</span> </p></center><p>Again, your answers will be accepted if they conform to this format and if at least <span class="tex-span">75%</span> of them are correct.</p><p>Again, you may process the input locally and submit just your precomputed answers (i.e., a program which just prints your output for the input file <span class="tex-font-style-tt">all.in</span>).</p>

## Note

<p>The link to download all the necessary materials is http://assets.codeforces.com/files/690/medium_contestant_package.zip</p>
